C51 COMPILER V9.59.0.0   MAIN                                                              05/28/2023 10:12:33 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX51.H>
   2          #include "Timer1_Init.h"
   3          #include "delay.h"
   4          #include "buzzer.h"
   5          
   6          
   7          unsigned int FreqSelect,MusicSelect;//频率选择位、乐谱序列选择位
   8          #define SPEED 700  //以四分音符为基准 
   9          sbit Buzzer = P2^5;//驱动芯片里对应蜂鸣器的IO口
  10          
  11          
  12          void main ()
  13          {
  14   1              Timer1_Init();//定时器初始化
  15   1              while(1)
  16   1              {
  17   2      //              if(Music_skycity[MusicSelect]!=0xff)   //0xff是乐谱结束标志位
  18   2      //              {
  19   2      //                      FreqSelect=Music_skycity[MusicSelect];
  20   2      //                      MusicSelect++;
  21   2      //                      delay(SPEED/32*Music_skycity[MusicSelect]);//音时
  22   2      //                      MusicSelect++;
  23   2      //                      TR1=0;             //定时暂停，让两个音之间有停顿
  24   2      //                      delay(5);
  25   2      //                      TR1=1;
  26   2      //              }
  27   2      //              else                    //终止音乐
  28   2      //              {
  29   2      //                      TR1=0;            
  30   2      //                      while(1);
  31   2      //              }
  32   2                      if(Music_qifengle[MusicSelect]!=0xff)   //0xff是乐谱结束标志位
  33   2                      {
  34   3                              FreqSelect=Music_qifengle[MusicSelect];
  35   3                              MusicSelect++;
  36   3                              delay(SPEED/32*Music_qifengle[MusicSelect]);//音时
  37   3                              MusicSelect++;
  38   3                              TR1=0;             //定时暂停，让两个音之间有停顿
  39   3                              delay(5);
  40   3                              TR1=1;
  41   3                      }
  42   2                      else                    //终止音乐
  43   2                      {
  44   3                              TR1=0;            
  45   3                              while(1);
  46   3                      }
  47   2              }
  48   1      }
  49          
  50          
  51          
  52          //中断所执行程序模板
  53          
  54          void Timer1_Routine () interrupt 3
C51 COMPILER V9.59.0.0   MAIN                                                              05/28/2023 10:12:33 PAGE 2   

  55          {
  56   1              if(Freq[FreqSelect])             //频率不为0时允许蜂鸣演奏
  57   1              {
  58   2                      TL1 = Freq[FreqSelect]%256;      //初始化中的值仅存在一次，这里的TL0和TH0才是持续存在的定时周期
  59   2                      TH1 = Freq[FreqSelect]/256;     
  60   2                      Buzzer=!Buzzer;
  61   2              }
  62   1               
  63   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    183    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
