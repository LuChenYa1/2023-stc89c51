C51 COMPILER V9.59.0.0   MAIN                                                              03/22/2024 20:44:49 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX51.H>
   2          #include "Matrixkey.h"
   3          #include "Timer0_Init.h"
   4          #include "delay.h"
   5          #include "nixie.h"
   6          #include "Key.h"
   7          
   8          sbit LED1 = P2^0;
   9          
  10          unsigned char KeyNum, Nixie_Num = 6, Hour = 23, MatrixKeyNum, Matrix_Value = 0, Count = 0;                        
  11          
  12          void main ()
  13          {
  14   1              Timer0_Init();
  15   1              
  16   1              while(1)
  17   1              {
  18   2                      KeyNum = Key();                                 //不断循环扫描四个独立按键是否按下
  19   2                      if(KeyNum)
  20   2                      {
  21   3                              if(KeyNum == 1)LED1 = !LED1;//题1：按键1控制灯的亮灭
  22   3                              
  23   3                              if(KeyNum == 2)                         //题2：按键2控制数字减1
  24   3                              {
  25   4                                      if(Nixie_Num == 0)Nixie_Num = 10;//越界判断
  26   4                                      Nixie_Num--;                    //“6”加加
  27   4                              }
  28   3                              
  29   3                              if(KeyNum == 3)                         //题2：按键3控制数字加1
  30   3                              {
  31   4                                      Nixie_Num++;                    //“6”减减
  32   4                                      if(Nixie_Num == 10)Nixie_Num = 0;//越界判断
  33   4                              }
  34   3                      }
  35   2                      
  36   2                      MatrixKeyNum = Matrixkey();             //题4：不断循环扫描矩阵键盘是否按下
  37   2                      if(MatrixKeyNum)                                  
  38   2                      { 
  39   3                              if(MatrixKeyNum <= 10)          //按键S1到S10分别代表数字1到9到0                               
  40   3                              {
  41   4                                      if(Count < 2)                   //目标是输入两位数字，Count用于计按下次数，按下两次后停止
             -Matrix_Value的增加               
  42   4                                      {
  43   5                                              Matrix_Value *= 10;                 
  44   5                                              Matrix_Value += MatrixKeyNum % 10; //每按一次，计数加一         
  45   5                                              Count++;                      
  46   5                                      }
  47   4                              }
  48   3                                      
  49   3                              if(MatrixKeyNum == 13)          //按键S13确认输入完成                    
  50   3                              {
  51   4                                      Hour = Matrix_Value;    //转存输入的值到“hour”中，方便原变量清零
  52   4                                      Count = 0;                              //此时可将按下次数清零，准备下次输入
  53   4                                      Matrix_Value = 0;               //值清零，准备下次从0开始输入
C51 COMPILER V9.59.0.0   MAIN                                                              03/22/2024 20:44:49 PAGE 2   

  54   4                              }
  55   3                      }       
  56   2                      
  57   2                      nixie(1,Nixie_Num);                             //将按键控制的数字“6”变化后的值显示出来
  58   2                      
  59   2                      nixie(8, Hour/10);                              //数码管特性，函数只能控制一位数字的显示，所以要写两次
  60   2                      nixie(7, Hour%10);                              //取余、取整
  61   2                      nixie(6, 17);                   //题3：动态数码管显示
  62   2                      nixie(5, 2);
  63   2                      nixie(4, 9);
  64   2                      nixie(3, 17);
  65   2                      nixie(2, 5);
  66   2              }
  67   1      }
  68          
  69          void Timer0_Routine () interrupt 1
  70          {
  71   1              static unsigned int T0count1,T0count2;     
  72   1      
  73   1              TL0 = 0x66;                                     
  74   1              TH0 = 0xFC;     
  75   1              
  76   1              T0count1++;
  77   1              if(T0count1 == 20)              
  78   1              {
  79   2                      T0count1=0;
  80   2                      Key_Loop();
  81   2              }
  82   1      
  83   1              T0count2++;
  84   1              if(T0count2 == 2)               
  85   1              {
  86   2                      T0count2=0;
  87   2                      nixie_Loop();
  88   2              }
  89   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    309    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
